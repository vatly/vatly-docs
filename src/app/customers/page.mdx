export const metadata = {
  title: 'Customers',
  description:
    'On this page, we’ll dive into the different customer endpoints you can use to manage customers programmatically.',
}

# Customers

As the name suggests, customers are a core part of Vatly — the very reason Vatly exists is so you can have secure conversations with your customers. On this page, we'll dive into the different customer endpoints you can use to manage customers programmatically. We'll look at how to query, create, update, and delete customers. {{ className: 'lead' }}

## The customer model

The customer model contains all the information about your customers, such as their username, avatar, and phone number. It also contains a reference to the conversation between you and the customer and information about when they were last active on Vatly.

### Properties

<Properties>
  <Property name="id" type="string">
    Unique identifier for the customer.
  </Property>
  <Property name="username" type="string">
    The username for the customer.
  </Property>
  <Property name="phone_number" type="string">
    The phone number for the customer.
  </Property>
  <Property name="avatar_url" type="string">
    The avatar image URL for the customer.
  </Property>
  <Property name="display_name" type="string">
    The customer display name in the customer list. By default, this is just the
    username.
  </Property>
  <Property name="conversation_id" type="string">
    Unique identifier for the conversation associated with the customer.
  </Property>
  <Property name="last_active_at" type="timestamp">
    Timestamp of when the customer was last active on the platform.
  </Property>
  <Property name="created_at" type="timestamp">
    Timestamp of when the customer was created.
  </Property>
</Properties>

---

## List all customers {{ tag: 'GET', label: '/v1/customers' }}

<Row>
  <Col>

    This endpoint allows you to retrieve a paginated list of all your customers. By default, a maximum of ten customers are shown per page.

    ### Optional attributes

    <Properties>
      <Property name="limit" type="integer">
        Limit the number of customers returned.
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="GET" label="/v1/customers">

    ```bash {{ title: 'cURL' }}
    curl -G https://api.vatly.com/v1/customers \
      -H "Authorization: Bearer {token}" \
      -d active=true \
      -d limit=10
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.customers.list()
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.customers.list()
    ```

    ```php
    $client = new \Vatly\ApiClient($token);

    $client->customers->list();
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "has_more": false,
      "data": [
        {
          "id": "WAz8eIbvDR60rouK",
          "username": "FrankMcCallister",
          "phone_number": "1-800-759-3000",
          "avatar_url": "https://assets.protocol.chat/avatars/frank.jpg",
          "display_name": null,
          "conversation_id": "xgQQXg3hrtjh7AvZ",
          "last_active_at": 705103200,
          "created_at": 692233200
        },
        {
          "id": "hSIhXBhNe8X1d8Et"
          // ...
        }
      ]
    }
    ```

  </Col>
</Row>

---

## Create a customer {{ tag: 'POST', label: '/v1/customers' }}

<Row>
  <Col>

    This endpoint allows you to add a new customer to your customer list in Vatly. To add a customer, you must provide their Vatly username and phone number.

    ### Required attributes

    <Properties>
      <Property name="username" type="string">
        The username for the customer.
      </Property>
      <Property name="phone_number" type="string">
        The phone number for the customer.
      </Property>
    </Properties>

    ### Optional attributes

    <Properties>
      <Property name="avatar_url" type="string">
        The avatar image URL for the customer.
      </Property>
      <Property name="display_name" type="string">
        The customer display name in the customer list. By default, this is just the username.
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/v1/customers">

    ```bash {{ title: 'cURL' }}
    curl https://api.vatly.com/v1/customers \
      -H "Authorization: Bearer {token}" \
      -d username="FrankMcCallister" \
      -d phone_number="1-800-759-3000" \
      -d avatar_url="https://assets.protocol.chat/avatars/frank.jpg"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.customers.create({
      username: 'FrankMcCallister',
      phone_number: '1-800-759-3000',
      avatar_url: 'https://assets.protocol.chat/avatars/frank.jpg',
    })
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.customers.create(
      username="FrankMcCallister",
      phone_number="1-800-759-3000",
      avatar_url="https://assets.protocol.chat/avatars/frank.jpg",
    )
    ```

    ```php
    $client = new \Vatly\ApiClient($token);

    $client->customers->create([
      'username' => 'FrankMcCallister',
      'phone_number' => '1-800-759-3000',
      'avatar_url' => 'https://assets.protocol.chat/avatars/frank.jpg',
    ]);
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "WAz8eIbvDR60rouK",
      "username": "FrankMcCallister",
      "phone_number": "1-800-759-3000",
      "avatar_url": "https://assets.protocol.chat/avatars/frank.jpg",
      "display_name": null,
      "conversation_id": "xgQQXg3hrtjh7AvZ",
      "last_active_at": null,
      "created_at": 692233200
    }
    ```

  </Col>
</Row>

---

## Retrieve a customer {{ tag: 'GET', label: '/v1/customers/:id' }}

<Row>
  <Col>

    This endpoint allows you to retrieve a customer by providing their Vatly id. Refer to [the list](#the-customer-model) at the top of this page to see which properties are included with customer objects.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="GET" label="/v1/customers/WAz8eIbvDR60rouK">

    ```bash {{ title: 'cURL' }}
    curl https://api.vatly.com/v1/customers/WAz8eIbvDR60rouK \
      -H "Authorization: Bearer {token}"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.customers.get('WAz8eIbvDR60rouK')
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.customers.get("WAz8eIbvDR60rouK")
    ```

    ```php
    $client = new \Vatly\ApiClient($token);

    $client->customers->get('WAz8eIbvDR60rouK');
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "WAz8eIbvDR60rouK",
      "username": "FrankMcCallister",
      "phone_number": "1-800-759-3000",
      "avatar_url": "https://assets.protocol.chat/avatars/frank.jpg",
      "display_name": null,
      "conversation_id": "xgQQXg3hrtjh7AvZ",
      "last_active_at": 705103200,
      "created_at": 692233200
    }
    ```

  </Col>
</Row>

---

## Update a customer {{ tag: 'PUT', label: '/v1/customers/:id' }}

<Row>
  <Col>

    This endpoint allows you to perform an update on a customer. Currently, the only attribute that can be updated on customers is the `display_name` attribute which controls how a customer appears in your customer list in Vatly.

    ### Optional attributes

    <Properties>
      <Property name="display_name" type="string">
        The customer display name in the customer list. By default, this is just the username.
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="PUT" label="/v1/customers/WAz8eIbvDR60rouK">

    ```bash {{ title: 'cURL' }}
    curl -X PUT https://api.vatly.com/v1/customers/WAz8eIbvDR60rouK \
      -H "Authorization: Bearer {token}" \
      -d display_name="UncleFrank"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.customers.update('WAz8eIbvDR60rouK', {
        display_name: 'UncleFrank',
    })
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.customers.update("WAz8eIbvDR60rouK", display_name="UncleFrank")
    ```

    ```php
    $client = new \Vatly\ApiClient($token);

    $client->customers->update('WAz8eIbvDR60rouK', [
      'display_name' => 'UncleFrank',
    ]);
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "WAz8eIbvDR60rouK",
      "username": "FrankMcCallister",
      "phone_number": "1-800-759-3000",
      "avatar_url": "https://assets.protocol.chat/avatars/frank.jpg",
      "display_name": "UncleFrank",
      "conversation_id": "xgQQXg3hrtjh7AvZ",
      "last_active_at": 705103200,
      "created_at": 692233200
    }
    ```

  </Col>
</Row>

---

## Delete a customer {{ tag: 'DELETE', label: '/v1/customers/:id' }}

<Row>
  <Col>

    This endpoint allows you to delete customers from your customer list in Vatly. Note: This will also delete your conversation with the given customer.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="DELETE" label="/v1/customers/WAz8eIbvDR60rouK">

    ```bash {{ title: 'cURL' }}
    curl -X DELETE https://api.vatly.com/v1/customers/WAz8eIbvDR60rouK \
      -H "Authorization: Bearer {token}"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.customers.delete('WAz8eIbvDR60rouK')
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.customers.delete("WAz8eIbvDR60rouK")
    ```

    ```php
    $client = new \Vatly\ApiClient($token);

    $client->customers->delete('WAz8eIbvDR60rouK');
    ```

    </CodeGroup>

  </Col>
</Row>
