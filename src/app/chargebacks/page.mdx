export const metadata = {
  title: 'Chargebacks',
  description:
    'On this page, we\'ll dive into the different chargeback endpoints you can use to manage chargebacks programmatically.',
}

# Chargebacks

Chargebacks represent payment disputes initiated by customers through their bank or card issuer. Chargebacks are created automatically when payment providers notify Vatly of a dispute. On this page, we'll dive into the different chargeback endpoints you can use to query chargebacks programmatically. {{ className: 'lead' }}

## The chargeback model

The chargeback model contains all the information about payment disputes, including the disputed amount, settlement amount, reason, and related order information.

### Properties

<Properties>
  <Property name="id" type="string">
    Unique identifier for the chargeback (starts with `chb_`).
  </Property>
  <Property name="resource" type="string">
    The resource type. Always `chargeback`.
  </Property>
  <Property name="merchantId" type="string">
    ID of the merchant.
  </Property>
  <Property name="testmode" type="boolean">
    Whether this chargeback is in test mode.
  </Property>
  <Property name="amount" type="Money">
    Amount of the chargeback. A Money object with `value` (decimal string) and `currency` (ISO 4217 code).
  </Property>
  <Property name="settlementAmount" type="Money">
    Amount that was deducted from the merchant's settlement. May differ from `amount` due to currency conversion or fees.
  </Property>
  <Property name="reason" type="string">
    Reason code or description for the chargeback. Common reasons include `fraud`, `product_not_received`, `product_unacceptable`, `duplicate`, or `subscription_canceled`.
  </Property>
  <Property name="originalOrderId" type="string">
    ID of the original order that was charged back.
  </Property>
  <Property name="orderId" type="string | null">
    ID of the credit note order created for this chargeback. Only present after the chargeback is processed.
  </Property>
  <Property name="createdAt" type="string">
    When this chargeback was created (ISO 8601 format).
  </Property>
  <Property name="links" type="object">
    HATEOAS links to related resources. Contains `self`, `originalOrder`, and optionally `order` (the credit note).
  </Property>
</Properties>

---

## List all chargebacks {{ tag: 'GET', label: '/v1/chargebacks' }}

<Row>
  <Col>
    This endpoint allows you to retrieve a paginated list of all chargebacks across all orders.

    ### Optional parameters
    <Properties>
      <Property name="limit" type="integer">
        The number of chargebacks to return (default: 10, max: 100).
      </Property>
      <Property name="startingAfter" type="string">
        A cursor for use in pagination. Returns results after this chargeback ID.
      </Property>
      <Property name="endingBefore" type="string">
        A cursor for use in pagination. Returns results before this chargeback ID.
      </Property>
    </Properties>
  </Col>
  <Col sticky>
    <CodeGroup title="Request" tag="GET" label="/v1/chargebacks">
    ```bash {{ title: 'cURL' }}
    curl -G https://api.vatly.com/v1/chargebacks \
      -H "Authorization: Bearer live_your_api_key_here" \
      -d limit=10
    ```

    ```php {{ title: 'PHP' }}
    $vatly = new \Vatly\API\VatlyApiClient();
    $vatly->setApiKey('live_your_api_key_here');

    $chargebacks = $vatly->chargebacks->page();
    ```
    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "data": [
        {
          "id": "chb_abc123def456",
          "resource": "chargeback",
          "merchantId": "mer_abc123",
          "testmode": false,
          "amount": {
            "value": "99.99",
            "currency": "EUR"
          },
          "settlementAmount": {
            "value": "114.99",
            "currency": "EUR"
          },
          "reason": "fraud",
          "originalOrderId": "ord_original123",
          "orderId": "ord_chargeback123",
          "createdAt": "2024-01-15T10:30:00Z",
          "links": {
            "self": {
              "href": "https://api.vatly.com/v1/chargebacks/chb_abc123def456",
              "type": "application/json"
            },
            "originalOrder": {
              "href": "https://api.vatly.com/v1/orders/ord_original123",
              "type": "application/json"
            },
            "order": {
              "href": "https://api.vatly.com/v1/orders/ord_chargeback123",
              "type": "application/json"
            }
          }
        }
      ],
      "links": {
        "self": {
          "href": "https://api.vatly.com/v1/chargebacks?limit=10",
          "type": "application/json"
        },
        "next": null,
        "prev": null
      },
      "count": 1
    }
    ```
  </Col>
</Row>

---

## Get a chargeback {{ tag: 'GET', label: '/v1/chargebacks/:chargebackId' }}

<Row>
  <Col>
    This endpoint allows you to retrieve a specific chargeback by its ID.

    ### Parameters
    <Properties>
      <Property name="chargebackId" type="string">
        The unique identifier of the chargeback.
      </Property>
    </Properties>
  </Col>
  <Col sticky>
    <CodeGroup title="Request" tag="GET" label="/v1/chargebacks/:chargebackId">
    ```bash {{ title: 'cURL' }}
    curl https://api.vatly.com/v1/chargebacks/chb_abc123def456 \
      -H "Authorization: Bearer live_your_api_key_here"
    ```

    ```php {{ title: 'PHP' }}
    $vatly = new \Vatly\API\VatlyApiClient();
    $vatly->setApiKey('live_your_api_key_here');

    $chargeback = $vatly->chargebacks->get('chb_abc123def456');
    ```
    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "chb_abc123def456",
      "resource": "chargeback",
      "merchantId": "mer_abc123",
      "testmode": false,
      "amount": {
        "value": "99.99",
        "currency": "EUR"
      },
      "settlementAmount": {
        "value": "114.99",
        "currency": "EUR"
      },
      "reason": "fraud",
      "originalOrderId": "ord_original123",
      "orderId": "ord_chargeback123",
      "createdAt": "2024-01-15T10:30:00Z",
      "links": {
        "self": {
          "href": "https://api.vatly.com/v1/chargebacks/chb_abc123def456",
          "type": "application/json"
        },
        "originalOrder": {
          "href": "https://api.vatly.com/v1/orders/ord_original123",
          "type": "application/json"
        },
        "order": {
          "href": "https://api.vatly.com/v1/orders/ord_chargeback123",
          "type": "application/json"
        }
      }
    }
    ```
  </Col>
</Row>

---

## List order chargebacks {{ tag: 'GET', label: '/v1/orders/:orderId/chargebacks' }}

<Row>
  <Col>
    This endpoint allows you to retrieve a paginated list of chargebacks for a specific order.

    ### Parameters
    <Properties>
      <Property name="orderId" type="string">
        The unique identifier of the order.
      </Property>
      <Property name="limit" type="integer">
        The number of chargebacks to return (default: 10, max: 100).
      </Property>
      <Property name="startingAfter" type="string">
        A cursor for use in pagination. Returns results after this chargeback ID.
      </Property>
      <Property name="endingBefore" type="string">
        A cursor for use in pagination. Returns results before this chargeback ID.
      </Property>
    </Properties>
  </Col>
  <Col sticky>
    <CodeGroup title="Request" tag="GET" label="/v1/orders/:orderId/chargebacks">
    ```bash {{ title: 'cURL' }}
    curl -G https://api.vatly.com/v1/orders/ord_original123/chargebacks \
      -H "Authorization: Bearer live_your_api_key_here" \
      -d limit=10
    ```

    ```php {{ title: 'PHP' }}
    $vatly = new \Vatly\API\VatlyApiClient();
    $vatly->setApiKey('live_your_api_key_here');

    $chargebacks = $vatly->orders->chargebacks('ord_original123')->page();
    ```
    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "data": [
        {
          "id": "chb_abc123def456",
          "resource": "chargeback",
          "merchantId": "mer_abc123",
          "testmode": false,
          "amount": {
            "value": "99.99",
            "currency": "EUR"
          },
          "settlementAmount": {
            "value": "114.99",
            "currency": "EUR"
          },
          "reason": "fraud",
          "originalOrderId": "ord_original123",
          "orderId": "ord_chargeback123",
          "createdAt": "2024-01-15T10:30:00Z",
          "links": {
            "self": {
              "href": "https://api.vatly.com/v1/chargebacks/chb_abc123def456",
              "type": "application/json"
            },
            "originalOrder": {
              "href": "https://api.vatly.com/v1/orders/ord_original123",
              "type": "application/json"
            },
            "order": {
              "href": "https://api.vatly.com/v1/orders/ord_chargeback123",
              "type": "application/json"
            }
          }
        }
      ],
      "links": {
        "self": {
          "href": "https://api.vatly.com/v1/orders/ord_original123/chargebacks?limit=10",
          "type": "application/json"
        },
        "next": null,
        "prev": null
      },
      "count": 1
    }
    ```
  </Col>
</Row>

---

## Get an order chargeback {{ tag: 'GET', label: '/v1/orders/:orderId/chargebacks/:chargebackId' }}

<Row>
  <Col>
    This endpoint allows you to retrieve a specific chargeback within an order context.

    ### Parameters
    <Properties>
      <Property name="orderId" type="string">
        The unique identifier of the order.
      </Property>
      <Property name="chargebackId" type="string">
        The unique identifier of the chargeback.
      </Property>
    </Properties>
  </Col>
  <Col sticky>
    <CodeGroup title="Request" tag="GET" label="/v1/orders/:orderId/chargebacks/:chargebackId">
    ```bash {{ title: 'cURL' }}
    curl https://api.vatly.com/v1/orders/ord_original123/chargebacks/chb_abc123def456 \
      -H "Authorization: Bearer live_your_api_key_here"
    ```

    ```php {{ title: 'PHP' }}
    $vatly = new \Vatly\API\VatlyApiClient();
    $vatly->setApiKey('live_your_api_key_here');

    $chargeback = $vatly->orders->chargebacks('ord_original123')->get('chb_abc123def456');
    ```
    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "chb_abc123def456",
      "resource": "chargeback",
      "merchantId": "mer_abc123",
      "testmode": false,
      "amount": {
        "value": "99.99",
        "currency": "EUR"
      },
      "settlementAmount": {
        "value": "114.99",
        "currency": "EUR"
      },
      "reason": "fraud",
      "originalOrderId": "ord_original123",
      "orderId": "ord_chargeback123",
      "createdAt": "2024-01-15T10:30:00Z",
      "links": {
        "self": {
          "href": "https://api.vatly.com/v1/chargebacks/chb_abc123def456",
          "type": "application/json"
        },
        "originalOrder": {
          "href": "https://api.vatly.com/v1/orders/ord_original123",
          "type": "application/json"
        },
        "order": {
          "href": "https://api.vatly.com/v1/orders/ord_chargeback123",
          "type": "application/json"
        }
      }
    }
    ```
  </Col>
</Row>
